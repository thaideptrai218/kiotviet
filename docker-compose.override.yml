version: '3.8'

services:
  # Development overrides
  app:
    environment:
      SPRING_PROFILES_ACTIVE: dev,docker
      LOGGING_LEVEL_FA_TRAINING_KIOTVIET: DEBUG
    volumes:
      - ./:/app:cached
      - ~/.m2:/root/.m2:cached
    command: ["java", "-jar", "-Dspring.profiles.active=dev,docker", "-agentlib:jdwp=transport=dt_socket,server=y,suspend=n,address=*:5005", "/app/app.jar"]
    ports:
      - "5005:5005"  # Debug port

  # Add development tools
  adminer:
    image: adminer:latest
    container_name: kiotviet-adminer
    restart: unless-stopped
    ports:
      - "8081:8080"
    networks:
      - kiotviet-network
    depends_on:
      - mysql

  redis-commander:
    image: rediscommander/redis-commander:latest
    container_name: kiotviet-redis-commander
    restart: unless-stopped
    environment:
      REDIS_HOSTS: local:redis:6379
    ports:
      - "8082:8081"
    networks:
      - kiotviet-network
    depends_on:
      - redis